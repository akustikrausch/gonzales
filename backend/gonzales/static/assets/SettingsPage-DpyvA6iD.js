import{a as n,j as e}from"./query-CSQiZfg4.js";import{c as j,q,S as f,r as H,s as V,t as W,l as J,M as K,v as O,w as Q,e as X,x as Y,y as Z,h as y,P as ee,z as se,B as x,A as te}from"./index-CC5wrdBP.js";import{G as o}from"./GlassCard-D-K6o67A.js";import{b as ae,c as $}from"./format-Bm42Q-0N.js";import{F as re}from"./file-text-BY-80UK-.js";import{S as z}from"./server-CnSvaqlL.js";import"./vendor-7Rr5RJ8N.js";/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],ne=j("bell",le);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],ce=j("palette",oe);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],b=j("save",ie);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],N=j("timer",de);function me({value:t,onChange:h}){const{data:s,isLoading:d,error:l}=q(),[c,g]=n.useState("");if(d)return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(f,{size:16}),e.jsx("span",{className:"text-sm",style:{color:"var(--g-text-secondary)"},children:"Loading servers..."})]});if(l)return e.jsx("p",{className:"text-sm",style:{color:"var(--g-red)"},children:"Failed to load servers. Speedtest CLI may not be available."});const m=(s==null?void 0:s.servers)||[],u=c?m.filter(a=>a.name.toLowerCase().includes(c.toLowerCase())||a.location.toLowerCase().includes(c.toLowerCase())||a.country.toLowerCase().includes(c.toLowerCase())):m;return e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{type:"text",placeholder:"Search servers...",value:c,onChange:a=>g(a.target.value),className:"glass-input"}),e.jsxs(H,{value:String(t),onChange:a=>h(Number(a.target.value)),children:[e.jsx("option",{value:"0",children:"Auto (nearest server)"}),u.map(a=>e.jsxs("option",{value:a.id,children:[a.name," - ",a.location,", ",a.country]},a.id))]})]})}const xe=[{value:"auto",label:"Auto",Icon:W},{value:"light",label:"Light",Icon:J},{value:"dark",label:"Dark",Icon:K}];function he(){const{theme:t,setTheme:h}=V();return e.jsx("div",{className:"flex gap-2",children:xe.map(({value:s,label:d,Icon:l})=>e.jsxs("button",{onClick:()=>h(s),className:"glass-btn flex-1 flex-col gap-1 py-3",style:{borderColor:t===s?"var(--g-blue)":void 0,background:t===s?"rgba(0, 122, 255, 0.1)":void 0,color:t===s?"var(--g-blue)":"var(--g-text)"},children:[e.jsx(l,{className:"w-5 h-5"}),e.jsx("span",{className:"text-xs font-medium",children:d})]},s))})}function Ne(){const{data:t,isLoading:h}=O(),{data:s}=Q(),{data:d}=X(),l=Y(),{mutate:c,isPending:g}=Z(),[m,u]=n.useState(""),[a,S]=n.useState(""),[v,w]=n.useState(""),[i,_]=n.useState(15),[k,C]=n.useState(0),[T,P]=n.useState(""),[M,D]=n.useState(""),[p,L]=n.useState("0");if(n.useEffect(()=>{t&&(u(String(t.test_interval_minutes)),S(String(t.download_threshold_mbps)),w(String(t.upload_threshold_mbps)),_(t.tolerance_percent),C(t.preferred_server_id),P(t.isp_name||""),D(t.webhook_url||""),L(String(t.data_retention_days||0)))},[t]),h)return e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx(f,{size:32})});const I=()=>{l.mutate({test_interval_minutes:Number(m),download_threshold_mbps:Number(a),upload_threshold_mbps:Number(v),tolerance_percent:i,preferred_server_id:k,isp_name:T})},B=Number(a)*(1-i/100),F=Number(v)*(1-i/100),U=Math.floor(1440/Number(m||60)),G=(Number(a||100)+Number(v||50))*10/8,A=U*G,R=A/1024,E=r=>{C(r),l.mutate({preferred_server_id:r})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2 g-animate-in",style:{color:"var(--g-text)"},children:[e.jsx(N,{className:"w-5 h-5"}),"Settings"]}),s&&e.jsxs(o,{className:"g-animate-in g-stagger-1",children:[e.jsxs("h3",{className:"text-sm font-semibold mb-4 flex items-center gap-2",style:{color:"var(--g-text)"},children:[e.jsx(N,{className:"w-4 h-4",style:{color:"var(--g-text-secondary)"}}),"Scheduler Control"]}),e.jsxs("div",{className:"space-y-4 max-w-md",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",style:{color:"var(--g-text)"},children:"Automatic Speed Tests"}),e.jsx("p",{className:"text-xs mt-1",style:{color:"var(--g-text-secondary)"},children:s.scheduler.enabled?`Running every ${s.scheduler.interval_minutes} minutes`:"Paused - only manual tests will run"})]}),e.jsxs(y,{variant:s.scheduler.enabled?"default":"primary",onClick:()=>c(!s.scheduler.enabled),disabled:g,"aria-label":s.scheduler.enabled?"Pause scheduler":"Resume scheduler",children:[g?e.jsx(f,{size:16}):s.scheduler.enabled?e.jsx(ee,{className:"w-4 h-4"}):e.jsx(se,{className:"w-4 h-4"}),g?"Updating...":s.scheduler.enabled?"Pause":"Resume"]})]}),s.scheduler.paused&&e.jsx("p",{className:"text-xs p-2 rounded",style:{background:"var(--g-yellow-tint)",color:"var(--g-yellow)"},children:'Scheduler is paused. Automatic speed tests are not running. Click "Resume" to restart automatic testing.'})]})]}),e.jsxs(o,{className:"g-animate-in g-stagger-2",children:[e.jsxs("h3",{className:"text-sm font-semibold mb-4 flex items-center gap-2",style:{color:"var(--g-text)"},children:[e.jsx(N,{className:"w-4 h-4",style:{color:"var(--g-text-secondary)"}}),"Test Configuration"]}),e.jsxs("div",{className:"space-y-4 max-w-md",children:[e.jsxs("div",{children:[e.jsx(x,{label:"Test Interval (minutes)",type:"number",min:1,max:1440,value:m,onChange:r=>u(r.target.value)}),e.jsxs("p",{className:"text-xs mt-2",style:{color:"var(--g-text-secondary)"},children:[U," tests/day · Est. ",R>=1?`${R.toFixed(1)} GB`:`${Math.round(A)} MB`,"/day data usage"]})]}),e.jsx(x,{label:"Download Threshold (Mbps)",type:"number",min:0,step:.1,value:a,onChange:r=>S(r.target.value)}),e.jsx(x,{label:"Upload Threshold (Mbps)",type:"number",min:0,step:.1,value:v,onChange:r=>w(r.target.value)}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",style:{color:"var(--g-text)"},children:["Tolerance: ",i,"%"]}),e.jsx("input",{type:"range",min:0,max:50,step:1,value:i,onChange:r=>_(Number(r.target.value)),className:"w-full h-2 rounded-lg appearance-none cursor-pointer",style:{background:`linear-gradient(to right, var(--g-accent) 0%, var(--g-accent) ${i*2}%, var(--g-border) ${i*2}%, var(--g-border) 100%)`}}),e.jsxs("p",{className:"text-xs mt-2",style:{color:"var(--g-text-secondary)"},children:["Minimum acceptable: ",B.toFixed(1)," Mbps down / ",F.toFixed(1)," Mbps up"]})]}),e.jsxs(y,{variant:"primary",onClick:I,disabled:l.isPending,children:[e.jsx(b,{className:"w-4 h-4"}),l.isPending?"Saving...":"Save Settings"]}),l.isSuccess&&e.jsx("p",{className:"text-xs",style:{color:"var(--g-green)"},children:"Settings saved."})]})]}),e.jsxs(o,{className:"g-animate-in g-stagger-3",children:[e.jsxs("h3",{className:"text-sm font-semibold mb-4 flex items-center gap-2",style:{color:"var(--g-text)"},children:[e.jsx(re,{className:"w-4 h-4",style:{color:"var(--g-text-secondary)"}}),"Contract Details"]}),e.jsxs("div",{className:"space-y-4 max-w-md",children:[e.jsx(x,{label:"ISP / Provider Name",type:"text",placeholder:"e.g., Deutsche Telekom",value:T,onChange:r=>P(r.target.value)}),e.jsx("p",{className:"text-xs",style:{color:"var(--g-text-secondary)"},children:"This information will be included in professional compliance reports. The speed thresholds above are used as your contracted speeds."}),e.jsxs(y,{variant:"primary",onClick:I,disabled:l.isPending,children:[e.jsx(b,{className:"w-4 h-4"}),l.isPending?"Saving...":"Save Settings"]})]})]}),e.jsxs(o,{className:"g-animate-in g-stagger-4",children:[e.jsxs("h3",{className:"text-sm font-semibold mb-4 flex items-center gap-2",style:{color:"var(--g-text)"},children:[e.jsx(z,{className:"w-4 h-4",style:{color:"var(--g-text-secondary)"}}),"Server Selection"]}),e.jsx("div",{className:"max-w-md",children:e.jsx(me,{value:k,onChange:E})})]}),e.jsxs(o,{className:"g-animate-in g-stagger-5",children:[e.jsxs("h3",{className:"text-sm font-semibold mb-4 flex items-center gap-2",style:{color:"var(--g-text)"},children:[e.jsx(ce,{className:"w-4 h-4",style:{color:"var(--g-text-secondary)"}}),"Appearance"]}),e.jsx("div",{className:"max-w-sm",children:e.jsx(he,{})})]}),e.jsxs(o,{className:"g-animate-in g-stagger-6",children:[e.jsxs("h3",{className:"text-sm font-semibold mb-4 flex items-center gap-2",style:{color:"var(--g-text)"},children:[e.jsx(ne,{className:"w-4 h-4",style:{color:"var(--g-text-secondary)"}}),"Notifications & Data"]}),e.jsxs("div",{className:"space-y-4 max-w-md",children:[e.jsxs("div",{children:[e.jsx(x,{label:"Webhook URL",type:"url",placeholder:"https://your-webhook.example.com/endpoint",value:M,onChange:r=>D(r.target.value)}),e.jsx("p",{className:"text-xs mt-2",style:{color:"var(--g-text-secondary)"},children:"Receive notifications for speed test results, outages, and threshold violations. Leave empty to disable webhooks."})]}),e.jsxs("div",{children:[e.jsx(x,{label:"Data Retention (days)",type:"number",min:0,max:3650,placeholder:"0",value:p,onChange:r=>L(r.target.value)}),e.jsx("p",{className:"text-xs mt-2",style:{color:"var(--g-text-secondary)"},children:Number(p)===0?"Unlimited - data is kept forever":`Measurements older than ${p} days will be automatically deleted`})]}),e.jsxs(y,{variant:"primary",onClick:()=>{l.mutate({webhook_url:M,data_retention_days:Number(p)})},disabled:l.isPending,children:[e.jsx(b,{className:"w-4 h-4"}),l.isPending?"Saving...":"Save Advanced Settings"]})]})]}),s&&e.jsxs(o,{className:"g-animate-in g-stagger-7",children:[e.jsxs("h3",{className:"text-sm font-semibold mb-4 flex items-center gap-2",style:{color:"var(--g-text)"},children:[e.jsx(te,{className:"w-4 h-4",style:{color:"var(--g-text-secondary)"}}),"System Status"]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-6 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{style:{color:"var(--g-text-secondary)"},children:"Version"}),e.jsxs("p",{className:"font-medium",style:{color:"var(--g-accent)"},children:["v",s.version]})]}),e.jsxs("div",{children:[e.jsx("p",{style:{color:"var(--g-text-secondary)"},children:"Uptime"}),e.jsx("p",{className:"font-medium",style:{color:"var(--g-text)"},children:ae(s.uptime_seconds)})]}),e.jsxs("div",{children:[e.jsx("p",{style:{color:"var(--g-text-secondary)"},children:"Total Measurements"}),e.jsx("p",{className:"font-medium",style:{color:"var(--g-text)"},children:s.total_measurements})]}),e.jsxs("div",{children:[e.jsx("p",{style:{color:"var(--g-text-secondary)"},children:"Total Failures"}),e.jsx("p",{className:"font-medium",style:{color:"var(--g-text)"},children:s.total_failures})]}),e.jsxs("div",{children:[e.jsx("p",{style:{color:"var(--g-text-secondary)"},children:"Database Size"}),e.jsx("p",{className:"font-medium",style:{color:"var(--g-text)"},children:$(s.db_size_bytes)})]}),e.jsxs("div",{children:[e.jsx("p",{style:{color:"var(--g-text-secondary)"},children:"Data Used by Tests"}),e.jsx("p",{className:"font-medium",style:{color:"var(--g-text)"},children:d?$(d.total_data_used_bytes):"—"})]})]})]}),t&&e.jsxs(o,{className:"g-animate-in g-stagger-8",children:[e.jsxs("h3",{className:"text-sm font-semibold mb-4 flex items-center gap-2",style:{color:"var(--g-text)"},children:[e.jsx(z,{className:"w-4 h-4",style:{color:"var(--g-text-secondary)"}}),"Server Info"]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{style:{color:"var(--g-text-secondary)"},children:"Host"}),e.jsx("p",{className:"font-medium",style:{color:"var(--g-text)"},children:t.host})]}),e.jsxs("div",{children:[e.jsx("p",{style:{color:"var(--g-text-secondary)"},children:"Port"}),e.jsx("p",{className:"font-medium",style:{color:"var(--g-text)"},children:t.port})]}),e.jsxs("div",{children:[e.jsx("p",{style:{color:"var(--g-text-secondary)"},children:"Log Level"}),e.jsx("p",{className:"font-medium",style:{color:"var(--g-text)"},children:t.log_level})]})]})]})]})}export{Ne as SettingsPage};
