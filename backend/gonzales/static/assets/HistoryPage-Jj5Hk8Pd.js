import{a as h,j as e}from"./query-CSQiZfg4.js";import{c as b,f as g,b as C,g as M,h as S,S as T}from"./index-W_z3pvWr.js";import{G as A}from"./GlassCard-BeFGED1K.js";import{D as z}from"./DateRangeFilter-B2Gfr40u.js";import{T as E,C as F}from"./triangle-alert-BJTqOhgF.js";import{X as L}from"./x-CYl-LCvX.js";import{f as U}from"./format-Cx2mhIEl.js";import{A as P,a as $}from"./arrow-up-kVT-SEau.js";import"./vendor-7Rr5RJ8N.js";/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],H=b("arrow-up-down",I);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],j=b("trash-2",R);function V({isOpen:x,onClose:a,onConfirm:l,isPending:r,totalCount:t}){const[s,c]=h.useState(""),m="DELETE";if(!x)return null;const o=s.toUpperCase()===m,y=()=>{o&&(l(),c(""))},p=()=>{c(""),a()};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",style:{background:"rgba(0, 0, 0, 0.5)",backdropFilter:"blur(4px)"},onClick:p,children:e.jsxs("div",{className:"w-full max-w-md rounded-xl p-6 shadow-xl",style:{background:"var(--g-glass)",border:"1px solid var(--g-border)"},onClick:d=>d.stopPropagation(),children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg",style:{background:"var(--g-red)20"},children:e.jsx(E,{className:"w-5 h-5",style:{color:"var(--g-red)"}})}),e.jsx("h3",{className:"text-lg font-semibold",style:{color:"var(--g-text)"},children:"Delete All Measurements"})]}),e.jsx("button",{onClick:p,className:"p-1 rounded-lg transition-colors",style:{color:"var(--g-text-secondary)"},onMouseEnter:d=>d.currentTarget.style.background="var(--g-border)",onMouseLeave:d=>d.currentTarget.style.background="transparent",children:e.jsx(L,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{style:{color:"var(--g-text-secondary)"},children:["You are about to permanently delete ",e.jsx("strong",{style:{color:"var(--g-text)"},children:t})," measurements. This action cannot be undone."]}),e.jsx("div",{className:"p-3 rounded-lg",style:{background:"var(--g-red)08",border:"1px solid var(--g-red)30"},children:e.jsx("p",{className:"text-sm",style:{color:"var(--g-red)"},children:"All historical data, statistics, and trends will be lost permanently."})}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm mb-2",style:{color:"var(--g-text-secondary)"},children:["Type ",e.jsx("strong",{style:{color:"var(--g-text)"},children:m})," to confirm:"]}),e.jsx("input",{type:"text",value:s,onChange:d=>c(d.target.value),placeholder:m,className:"w-full px-3 py-2 rounded-lg text-sm",style:{background:"var(--g-input-bg)",border:"1px solid var(--g-border)",color:"var(--g-text)"},autoFocus:!0})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx(g,{onClick:p,className:"flex-1",children:"Cancel"}),e.jsxs(g,{onClick:y,disabled:!o||r,className:"flex-1",style:{background:o?"var(--g-red)":void 0,color:o?"white":void 0,opacity:o?1:.5},children:[e.jsx(j,{className:"w-4 h-4"}),r?"Deleting...":"Delete All"]})]})]})]})})}function u({label:x,field:a,sortBy:l,sortOrder:r,onSort:t,align:s="right"}){const c=l===a;return e.jsx("th",{className:`py-3 px-3 font-medium cursor-pointer select-none transition-colors ${s==="left"?"text-left":"text-right"}`,style:{color:"var(--g-text-secondary)",fontSize:"var(--g-text-xs)"},onClick:()=>t==null?void 0:t(a),children:e.jsxs("span",{className:"inline-flex items-center gap-1",children:[x,c?r==="asc"?e.jsx(P,{className:"w-3 h-3"}):e.jsx($,{className:"w-3 h-3"}):e.jsx(H,{className:"w-3 h-3 opacity-40"})]})})}function G({measurements:x,onDelete:a,sortBy:l,sortOrder:r,onSort:t}){return e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"glass-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx(u,{label:"Time",field:"timestamp",sortBy:l,sortOrder:r,onSort:t,align:"left"}),e.jsx(u,{label:"Download",field:"download_mbps",sortBy:l,sortOrder:r,onSort:t}),e.jsx(u,{label:"Upload",field:"upload_mbps",sortBy:l,sortOrder:r,onSort:t}),e.jsx(u,{label:"Ping",field:"ping_latency_ms",sortBy:l,sortOrder:r,onSort:t}),e.jsx(u,{label:"Jitter",field:"ping_jitter_ms",sortBy:l,sortOrder:r,onSort:t}),e.jsx("th",{className:"text-left py-3 px-3 font-medium",style:{color:"var(--g-text-secondary)",fontSize:"var(--g-text-xs)"},children:"Server"}),e.jsx("th",{className:"text-center py-3 px-3 font-medium",style:{color:"var(--g-text-secondary)",fontSize:"var(--g-text-xs)"},title:"Threshold violations: DL = Download below minimum, UL = Upload below minimum",children:"Issues"}),e.jsx("th",{className:"py-3 px-3"})]})}),e.jsx("tbody",{children:x.map((s,c)=>{const m=s.below_download_threshold||s.below_upload_threshold;return e.jsxs("tr",{className:"g-animate-in",style:{animationDelay:`${Math.min(c*30,300)}ms`,background:m?"rgba(255, 59, 48, 0.05)":void 0},children:[e.jsx("td",{className:"py-2.5 px-3",style:{color:"var(--g-text)"},children:U(s.timestamp)}),e.jsx("td",{className:"py-2.5 px-3 text-right font-medium tabular-nums",style:{color:"var(--g-blue)"},children:s.download_mbps.toFixed(1)}),e.jsx("td",{className:"py-2.5 px-3 text-right font-medium tabular-nums",style:{color:"var(--g-green)"},children:s.upload_mbps.toFixed(1)}),e.jsx("td",{className:"py-2.5 px-3 text-right tabular-nums",style:{color:"var(--g-text)"},children:s.ping_latency_ms.toFixed(1)}),e.jsx("td",{className:"py-2.5 px-3 text-right tabular-nums",style:{color:"var(--g-text)"},children:s.ping_jitter_ms.toFixed(1)}),e.jsx("td",{className:"py-2.5 px-3 max-w-[150px] truncate",style:{color:"var(--g-text-secondary)"},children:s.server_name}),e.jsx("td",{className:"py-2.5 px-3 text-center",children:m&&e.jsxs("span",{className:"text-xs font-medium cursor-help",style:{color:"var(--g-red)"},title:`${s.below_download_threshold?"Download below threshold":""}${s.below_download_threshold&&s.below_upload_threshold?", ":""}${s.below_upload_threshold?"Upload below threshold":""}`,children:[s.below_download_threshold&&"DL",s.below_download_threshold&&s.below_upload_threshold&&" / ",s.below_upload_threshold&&"UL"]})}),e.jsx("td",{className:"py-2.5 px-3",children:a&&e.jsx("button",{onClick:()=>a(s.id),className:"glass-focus-ring rounded transition-colors",style:{color:"var(--g-text-secondary)"},title:"Delete",onMouseEnter:o=>o.currentTarget.style.color="var(--g-red)",onMouseLeave:o=>o.currentTarget.style.color="var(--g-text-secondary)",children:e.jsx(j,{className:"w-4 h-4"})})})]},s.id)})})]})})}function B(){const[x,a]=h.useState(1),[l,r]=h.useState(""),[t,s]=h.useState(""),[c,m]=h.useState("timestamp"),[o,y]=h.useState("desc"),[p,d]=h.useState(!1),f=n=>{n===c?y(k=>k==="asc"?"desc":"asc"):(m(n),y("desc")),a(1)},N={page:x,page_size:25,start_date:l?new Date(l).toISOString():void 0,end_date:t?new Date(t).toISOString():void 0,sort_by:c,sort_order:o},{data:i,isLoading:w}=C(N),_=M(),v=S(),D=()=>{v.mutate(void 0,{onSuccess:()=>{d(!1),a(1)}})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between g-animate-in",children:[e.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2",style:{color:"var(--g-text)"},children:[e.jsx(F,{className:"w-5 h-5"}),"History"]}),e.jsx(z,{startDate:l,endDate:t,onStartDateChange:n=>{r(n),a(1)},onEndDateChange:n=>{s(n),a(1)}})]}),e.jsx(A,{padding:"none",className:"g-animate-in g-stagger-1",children:e.jsx("div",{className:"p-5",children:w?e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx(T,{size:32})}):i&&i.items.length>0?e.jsxs(e.Fragment,{children:[e.jsx(G,{measurements:i.items,onDelete:n=>_.mutate(n),sortBy:c,sortOrder:o,onSort:f}),e.jsxs("div",{className:"flex items-center justify-between mt-4 pt-4 border-t",style:{borderColor:"var(--g-border)"},children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("p",{className:"text-xs",style:{color:"var(--g-text-secondary)"},children:[i.total," measurements total"]}),e.jsxs(g,{size:"sm",onClick:()=>d(!0),style:{color:"var(--g-red)"},children:[e.jsx(j,{className:"w-3 h-3"}),"Delete All"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(g,{size:"sm",onClick:()=>a(n=>Math.max(1,n-1)),disabled:x<=1,children:"Previous"}),e.jsxs("span",{className:"text-xs px-2 py-1",style:{color:"var(--g-text-secondary)"},children:["Page ",i.page," of ",i.pages]}),e.jsx(g,{size:"sm",onClick:()=>a(n=>Math.min(i.pages,n+1)),disabled:x>=i.pages,children:"Next"})]})]})]}):e.jsx("p",{className:"text-center py-12",style:{color:"var(--g-text-secondary)"},children:"No measurements found."})})}),e.jsx(V,{isOpen:p,onClose:()=>d(!1),onConfirm:D,isPending:v.isPending,totalCount:(i==null?void 0:i.total)??0})]})}export{B as HistoryPage};
