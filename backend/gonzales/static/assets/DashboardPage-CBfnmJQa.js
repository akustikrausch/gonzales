import{j as e,a as g}from"./query-CSQiZfg4.js";import{c as Q,u as S,a as he,A as L,T as pe,G as ge,C as Z,b as fe,Z as J,d as ve,e as je,f as ye,g as be,h as we,i as Ne,S as ke,j as _e}from"./index-C_tx9rzG.js";import{G as F}from"./GlassCard-D-K6o67A.js";import{A as Me,u as ee,P as q}from"./ProgressRing-CTDihKXk.js";import{f as te,a as se}from"./format-Bm42Q-0N.js";import{R as ae,L as re,C as ne,X as oe,Y as le,T as ie,a as $e,b as Y,c as P}from"./charts-ZBqAZ0pw.js";import{L as Ce}from"./vendor-7Rr5RJ8N.js";import{C as Re}from"./chevron-right-DEeEX10T.js";import{H as Se}from"./house-DKZVsXpI.js";import{R as Ae,U as Le,B as Fe,G as We,a as De,V as Ge,T as Ie}from"./video-B7vUAwBB.js";import{A as ce,a as O}from"./arrow-up-DcQFLzGV.js";import{W as Pe}from"./wifi-CE0v8NTZ.js";/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=[["path",{d:"M15.033 9.44a.647.647 0 0 1 0 1.12l-4.065 2.352a.645.645 0 0 1-.968-.56V7.648a.645.645 0 0 1 .967-.56z",key:"vbtd3f"}],["path",{d:"M12 17v4",key:"1riwvh"}],["path",{d:"M8 21h8",key:"1ev6f3"}],["rect",{x:"2",y:"3",width:"20",height:"14",rx:"2",key:"x3v2xh"}]],He=Q("monitor-play",Te);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=[["path",{d:"M2.5 17a24.12 24.12 0 0 1 0-10 2 2 0 0 1 1.4-1.4 49.56 49.56 0 0 1 16.2 0A2 2 0 0 1 21.5 7a24.12 24.12 0 0 1 0 10 2 2 0 0 1-1.4 1.4 49.55 49.55 0 0 1-16.2 0A2 2 0 0 1 2.5 17",key:"1q2vi4"}],["path",{d:"m10 15 5-3-5-3z",key:"1jp15x"}]],Be=Q("youtube",ze);function H({label:t,sublabel:s,value:a,unit:r="Mbps",color:n,threshold:o,thresholdLabel:i}){const m=o!==void 0,c=m&&a<o,p=m&&a>=o;return e.jsxs(F,{hover:!0,className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("p",{className:"text-sm font-medium",style:{color:"var(--g-text-secondary)"},children:t}),s&&e.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded",style:{background:"var(--g-surface)",color:"var(--g-text-secondary)"},children:s})]}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx(Me,{value:a,decimals:1,className:"text-5xl font-bold tracking-tight",style:{color:c?"var(--g-red)":p?"var(--g-green)":n}}),e.jsx("span",{className:"text-lg font-medium",style:{color:"var(--g-text-secondary)"},children:r})]}),m&&e.jsxs("p",{className:"text-xs mt-2 font-medium",style:{color:c?"var(--g-red)":"var(--g-green)"},children:[c?"Below threshold":"Above threshold"," (",i||`${o} ${r}`,")"]})]})}function Oe(t,s,a){if(s)return a("latestResult.vpn");const r=t.toLowerCase();return r.startsWith("eth")||r.startsWith("en")||r.startsWith("docker")||r.startsWith("br")?a("latestResult.ethernet"):r.startsWith("wl")||r.startsWith("wi")||r.includes("wifi")||r.includes("wlan")?a("latestResult.wifi"):r.startsWith("tun")||r.startsWith("tap")||r.startsWith("wg")?a("latestResult.vpn"):!r||r==="unknown"?a("latestResult.unknown"):t}function Ee({measurement:t}){const{t:s}=S();return e.jsxs(F,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold",style:{color:"var(--g-text)"},children:s("latestResult.title")}),e.jsx("span",{className:"text-xs",style:{color:"var(--g-text-secondary)"},children:te(t.timestamp)})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{style:{color:"var(--g-text-secondary)"},children:s("latestResult.server")}),e.jsx("p",{className:"font-medium",style:{color:"var(--g-text)"},children:t.server_name})]}),e.jsxs("div",{children:[e.jsx("p",{style:{color:"var(--g-text-secondary)"},children:"Location"}),e.jsx("p",{className:"font-medium",style:{color:"var(--g-text)"},children:t.server_location})]}),e.jsxs("div",{children:[e.jsx("p",{style:{color:"var(--g-text-secondary)"},children:s("latestResult.isp")}),e.jsx("p",{className:"font-medium",style:{color:"var(--g-text)"},children:t.isp})]}),e.jsxs("div",{children:[e.jsx("p",{style:{color:"var(--g-text-secondary)"},children:s("latestResult.jitter")}),e.jsx("p",{className:"font-medium",style:{color:"var(--g-text)"},children:t.ping_jitter_ms!==null&&t.ping_jitter_ms!==void 0?`${t.ping_jitter_ms.toFixed(1)} ${s("common.ms")}`:s("common.noData")})]}),e.jsxs("div",{children:[e.jsx("p",{style:{color:"var(--g-text-secondary)"},children:s("latestResult.packetLoss")}),e.jsx("p",{className:"font-medium",style:{color:"var(--g-text)"},children:t.packet_loss_pct!==null&&t.packet_loss_pct!==void 0?`${t.packet_loss_pct.toFixed(1)}%`:s("common.noData")})]}),e.jsxs("div",{children:[e.jsx("p",{style:{color:"var(--g-text-secondary)"},children:s("latestResult.connectionType")}),e.jsx("p",{className:"font-medium",style:{color:"var(--g-text)"},children:Oe(t.interface_name,t.is_vpn,s)})]})]})]})}const qe=g.memo(function({measurements:s,downloadThreshold:a,uploadThreshold:r}){const{t:n}=S(),o=g.useMemo(()=>[...s].reverse().map(i=>({time:se(i.timestamp),download:Number(i.download_mbps.toFixed(1)),upload:Number(i.upload_mbps.toFixed(1))})),[s]);return e.jsxs(F,{children:[e.jsxs("h3",{className:"text-sm font-semibold mb-4",style:{color:"var(--g-text)"},children:[n("dashboard.download")," / ",n("dashboard.upload")]}),e.jsx(ae,{width:"100%",height:300,children:e.jsxs(re,{data:o,children:[e.jsx(ne,{strokeDasharray:"3 3",stroke:"var(--g-border)"}),e.jsx(oe,{dataKey:"time",tick:{fontSize:11},stroke:"var(--g-text-tertiary)"}),e.jsx(le,{tick:{fontSize:11},stroke:"var(--g-text-tertiary)",unit:` ${n("common.mbps")}`}),e.jsx(ie,{contentStyle:{background:"var(--g-card-bg)",border:"1px solid var(--g-card-border)",borderRadius:"var(--g-radius-sm)",backdropFilter:"blur(20px)",fontSize:"var(--g-text-xs)"}}),e.jsx($e,{}),a&&e.jsx(Y,{y:a,stroke:"var(--g-blue)",strokeDasharray:"5 5",strokeOpacity:.7,label:{value:n("dashboard.minThreshold",{value:a}),position:"right",fill:"var(--g-blue)",fontSize:10}}),r&&e.jsx(Y,{y:r,stroke:"var(--g-green)",strokeDasharray:"5 5",strokeOpacity:.7,label:{value:n("dashboard.minThreshold",{value:r}),position:"right",fill:"var(--g-green)",fontSize:10}}),e.jsx(P,{type:"monotone",dataKey:"download",stroke:"var(--g-blue)",strokeWidth:2,dot:!1,name:n("speedtest.download"),animationDuration:800,animationBegin:0,animationEasing:"ease-out"}),e.jsx(P,{type:"monotone",dataKey:"upload",stroke:"var(--g-green)",strokeWidth:2,dot:!1,name:n("speedtest.upload"),animationDuration:800,animationBegin:200,animationEasing:"ease-out"})]})})]})});function Ye({measurements:t}){const{t:s}=S(),a=[...t].reverse().map(r=>({time:se(r.timestamp),ping:Number(r.ping_latency_ms.toFixed(1)),jitter:Number(r.ping_jitter_ms.toFixed(1))}));return e.jsxs(F,{children:[e.jsxs("h3",{className:"text-sm font-semibold mb-4",style:{color:"var(--g-text)"},children:[s("dashboard.ping")," / ",s("latestResult.jitter")]}),e.jsx(ae,{width:"100%",height:250,children:e.jsxs(re,{data:a,children:[e.jsx(ne,{strokeDasharray:"3 3",stroke:"var(--g-border)"}),e.jsx(oe,{dataKey:"time",tick:{fontSize:11},stroke:"var(--g-text-tertiary)"}),e.jsx(le,{tick:{fontSize:11},stroke:"var(--g-text-tertiary)",unit:` ${s("common.ms")}`}),e.jsx(ie,{contentStyle:{background:"var(--g-card-bg)",border:"1px solid var(--g-card-border)",borderRadius:"var(--g-radius-sm)",backdropFilter:"blur(20px)",fontSize:"var(--g-text-xs)"}}),e.jsx(P,{type:"monotone",dataKey:"ping",stroke:"var(--g-orange)",strokeWidth:2,dot:!1,name:s("common.ping"),animationDuration:800,animationBegin:0,animationEasing:"ease-out"}),e.jsx(P,{type:"monotone",dataKey:"jitter",stroke:"var(--g-purple)",strokeWidth:2,dot:!1,name:s("latestResult.jitter"),animationDuration:800,animationBegin:200,animationEasing:"ease-out"})]})})]})}const Ve={netflix_4k:Ie,youtube_4k:Be,zoom_hd:Ge,teams_call:De,cloud_gaming:He,online_gaming:We,vpn_work:Fe,video_upload:Le,live_streaming:Ae,smart_home:Se};function Xe(){const{t}=S(),{data:s,isLoading:a}=he();if(a||!s)return null;const r=s.passed_profiles,n=s.total_profiles,o=Math.round(r/n*100);return e.jsxs("div",{className:"glass-card p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{className:"w-4 h-4",style:{color:"var(--g-accent)"}}),e.jsx("h3",{className:"font-semibold text-sm",style:{color:"var(--g-text)"},children:t("qos.applicationCompatibility")})]}),e.jsxs(Ce,{to:"/qos",className:"flex items-center gap-1 text-xs hover:underline",style:{color:"var(--g-accent)"},children:[t("qos.viewAll"),e.jsx(Re,{className:"w-3 h-3"})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1",style:{color:"var(--g-text-secondary)"},children:[e.jsxs("span",{children:[r," of ",n," ",t("qos.optimal").toLowerCase()]}),e.jsxs("span",{children:[o,"%"]})]}),e.jsx("div",{className:"h-1.5 rounded-full",style:{backgroundColor:"var(--g-surface)"},children:e.jsx("div",{className:"h-full rounded-full transition-all",style:{width:`${o}%`,backgroundColor:o>=80?"var(--g-green)":o>=50?"var(--g-amber)":"var(--g-red)"}})})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.results.slice(0,6).map(i=>{const m=Ve[i.profile_id]||L,c=i.passed?t("qos.optimal"):t("qos.limited");return e.jsx("div",{title:`${i.profile_name}: ${c}`,className:"w-8 h-8 rounded-lg flex items-center justify-center",style:{backgroundColor:i.passed?"rgba(34, 197, 94, 0.15)":"rgba(239, 68, 68, 0.15)"},children:e.jsx(m,{className:"w-4 h-4",style:{color:i.passed?"var(--g-green)":"var(--g-red)"}})},i.profile_id)}),s.results.length>6&&e.jsxs("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center text-xs font-medium",style:{backgroundColor:"var(--g-surface)",color:"var(--g-text-secondary)"},children:["+",s.results.length-6]})]})]})}function Ke(t){return t>=80?"var(--g-green)":t>=60?"var(--g-blue)":t>=40?"var(--g-orange)":"var(--g-red)"}function Ue(t,s){switch(t){case"A+":case"A":return s("connectionHealth.excellent");case"B":return s("connectionHealth.good");case"C":return s("connectionHealth.fair");case"D":return s("connectionHealth.poor");default:return s("connectionHealth.bad")}}function Qe(t,s){return t>=85?s("connectionHealth.excellent"):t>=70?s("connectionHealth.good"):t>=50?s("connectionHealth.fair"):t>=30?s("connectionHealth.poor"):s("connectionHealth.bad")}function I({label:t,value:s,color:a}){return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-[10px]",style:{color:"var(--g-text-secondary)"},children:t}),e.jsx("span",{className:"text-[10px] font-medium tabular-nums",style:{color:"var(--g-text)"},children:s.toFixed(0)})]}),e.jsx("div",{className:"h-1.5 rounded-full",style:{background:"var(--g-border)"},children:e.jsx("div",{className:"h-full rounded-full transition-all duration-700",style:{width:`${Math.min(s,100)}%`,background:a}})})]})}function Ze({score:t}){const{t:s}=S();if(!t)return null;const a=Ke(t.composite),r=Ue(t.grade,s),n=Qe(t.composite,s),o=80,i=6,m=(o-i)/2,c=2*Math.PI*m,p=t.composite/100*c;return e.jsx(F,{children:e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"shrink-0 relative",style:{width:o,height:o},children:[e.jsxs("svg",{width:o,height:o,className:"-rotate-90",children:[e.jsx("circle",{cx:o/2,cy:o/2,r:m,fill:"none",stroke:"var(--g-border)",strokeWidth:i}),e.jsx("circle",{cx:o/2,cy:o/2,r:m,fill:"none",stroke:a,strokeWidth:i,strokeLinecap:"round",strokeDasharray:c,strokeDashoffset:c-p,className:"transition-all duration-1000"})]}),e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[e.jsx("span",{className:"text-lg font-bold",style:{color:a},children:t.grade}),e.jsx("span",{className:"text-[9px]",style:{color:"var(--g-text-tertiary)"},children:t.composite.toFixed(0)})]})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"text-sm font-semibold",style:{color:"var(--g-text)"},children:s("connectionHealth.title")}),e.jsx("span",{className:"text-xs font-medium px-2 py-0.5 rounded-full",style:{color:a,background:`${a}15`},children:r})]}),e.jsx("p",{className:"text-xs mb-3",style:{color:"var(--g-text-secondary)"},children:n}),e.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1.5",children:[e.jsx(I,{label:s("connectionHealth.speed"),value:t.breakdown.speed_score,color:"var(--g-blue)"}),e.jsx(I,{label:s("connectionHealth.reliability"),value:t.breakdown.reliability_score,color:"var(--g-green)"}),e.jsx(I,{label:s("connectionHealth.latency"),value:t.breakdown.latency_score,color:"var(--g-orange)"}),e.jsx(I,{label:s("connectionHealth.consistency"),value:t.breakdown.consistency_score,color:"var(--g-teal)"})]})]})]})})}function Je({outage:t}){const{t:s}=S();return t.outage_active?e.jsxs("div",{role:"alert",className:"flex items-center gap-3 p-3 rounded-xl g-animate-in",style:{background:"var(--g-red)12",border:"1px solid var(--g-red)30"},children:[e.jsx(pe,{className:"w-5 h-5 shrink-0",style:{color:"var(--g-red)"}}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-sm font-semibold",style:{color:"var(--g-red)"},children:s("outageAlert.outageDetected")}),e.jsxs("p",{className:"text-xs",style:{color:"var(--g-text-secondary)"},children:[s("outageAlert.failures",{count:t.consecutive_failures}),t.outage_started_at&&` ${s("outageAlert.since",{time:te(t.outage_started_at)})}`]})]})]}):null}function et(){const t=g.useRef([]),s=g.useRef(0),[a,r]=g.useState(0),n=g.useRef(0),o=g.useCallback((c,p)=>{t.current.push({time:p,value:c}),c>s.current&&(s.current=c);const h=performance.now();h-n.current>250&&(n.current=h,r(u=>u+1))},[]),i=g.useCallback(()=>{t.current=[],s.current=0,n.current=0,r(0)},[]),m=g.useCallback(()=>{r(c=>c+1)},[]);return{samples:t.current,peak:s.current,push:o,reset:i,flush:m,version:a}}function V({value:t,max:s=1e3,label:a,color:r="var(--g-blue)",unit:n="Mbps",glowColor:o}){const i=g.useId(),m=`needleGlow${i}`,c=`arcGlow${i}`,p=`tipPulse${i}`,h=`arcGradient${i}`,u=ee(t,400),y=Math.min(u,s),f=-210,N=240,R=f+y/s*N,l=80,d=100,x=105,b=o||r,k=[0,.25,.5,.75,1].map(j=>{const M=(f+j*N)*(Math.PI/180);return{x1:d+(l-10)*Math.cos(M),y1:x+(l-10)*Math.sin(M),x2:d+l*Math.cos(M),y2:x+l*Math.sin(M),label:Math.round(j*s),lx:d+(l-18)*Math.cos(M),ly:x+(l-18)*Math.sin(M)}}),v=Array.from({length:21},(j,M)=>{const E=M/20,G=(f+E*N)*(Math.PI/180);return{x1:d+(l-4)*Math.cos(G),y1:x+(l-4)*Math.sin(G),x2:d+l*Math.cos(G),y2:x+l*Math.sin(G),active:E<=y/s}}),w=f*(Math.PI/180),$=R*(Math.PI/180),T=d+l*Math.cos(w),W=x+l*Math.sin(w),C=d+l*Math.cos($),A=x+l*Math.sin($),_=R-f>180?1:0,D=R*(Math.PI/180),de=d+(l-18)*Math.cos(D),ue=x+(l-18)*Math.sin(D),xe=d+(l-20)*Math.cos(D),me=x+(l-20)*Math.sin(D);return e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("svg",{viewBox:"0 0 200 155",className:"w-full max-w-[260px]",children:[e.jsxs("defs",{children:[e.jsxs("filter",{id:m,x:"-50%",y:"-50%",width:"200%",height:"200%",children:[e.jsx("feGaussianBlur",{stdDeviation:"3",result:"blur"}),e.jsx("feFlood",{floodColor:b,floodOpacity:"0.6",result:"color"}),e.jsx("feComposite",{in:"color",in2:"blur",operator:"in",result:"glow"}),e.jsxs("feMerge",{children:[e.jsx("feMergeNode",{in:"glow"}),e.jsx("feMergeNode",{in:"SourceGraphic"})]})]}),e.jsxs("filter",{id:c,x:"-20%",y:"-20%",width:"140%",height:"140%",children:[e.jsx("feGaussianBlur",{stdDeviation:"2.5",result:"blur"}),e.jsx("feFlood",{floodColor:b,floodOpacity:"0.4",result:"color"}),e.jsx("feComposite",{in:"color",in2:"blur",operator:"in",result:"glow"}),e.jsxs("feMerge",{children:[e.jsx("feMergeNode",{in:"glow"}),e.jsx("feMergeNode",{in:"SourceGraphic"})]})]}),e.jsx("filter",{id:p,x:"-100%",y:"-100%",width:"300%",height:"300%",children:e.jsx("feGaussianBlur",{stdDeviation:"4"})}),e.jsxs("linearGradient",{id:h,x1:"0",y1:"0",x2:"1",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:r,stopOpacity:"0.3"}),e.jsx("stop",{offset:"100%",stopColor:r,stopOpacity:"1"})]})]}),e.jsx("path",{d:`M ${d+l*Math.cos(w)} ${x+l*Math.sin(w)} A ${l} ${l} 0 1 1 ${d+l*Math.cos((f+N)*Math.PI/180)} ${x+l*Math.sin((f+N)*Math.PI/180)}`,fill:"none",stroke:"var(--g-border)",strokeWidth:"6",strokeLinecap:"round",opacity:"0.5"}),u>0&&e.jsx("path",{d:`M ${d+l*Math.cos(w)} ${x+l*Math.sin(w)} A ${l} ${l} 0 1 1 ${d+l*Math.cos((f+N)*Math.PI/180)} ${x+l*Math.sin((f+N)*Math.PI/180)}`,fill:"none",stroke:r,strokeWidth:"8",strokeLinecap:"round",filter:`url(#${c})`,children:e.jsx("animate",{attributeName:"opacity",values:"0.05;0.15;0.05",dur:"3s",repeatCount:"indefinite"})}),v.map((j,M)=>e.jsx("line",{x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,stroke:j.active?r:"var(--g-border)",strokeWidth:"1",strokeLinecap:"round",opacity:j.active?.8:.3},`minor-${M}`)),u>0&&e.jsx("path",{d:`M ${T} ${W} A ${l} ${l} 0 ${_} 1 ${C} ${A}`,fill:"none",stroke:`url(#${h})`,strokeWidth:"6",strokeLinecap:"round",filter:`url(#${c})`}),k.map((j,M)=>e.jsxs("g",{children:[e.jsx("line",{x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,stroke:"var(--g-text-tertiary)",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("text",{x:j.lx,y:j.ly,textAnchor:"middle",dominantBaseline:"middle",fill:"var(--g-text-secondary)",fontSize:"7",fontWeight:"500",children:j.label})]},`major-${M}`)),e.jsx("line",{x1:d,y1:x,x2:de,y2:ue,stroke:r,strokeWidth:"2",strokeLinecap:"round",filter:`url(#${m})`}),e.jsx("circle",{cx:d,cy:x,r:"5",fill:r,opacity:"0.9"}),e.jsx("circle",{cx:d,cy:x,r:"3",fill:"var(--g-bg)"}),u>0&&e.jsxs("circle",{cx:xe,cy:me,r:"6",fill:r,filter:`url(#${p})`,opacity:"0.5",children:[e.jsx("animate",{attributeName:"opacity",values:"0.3;0.7;0.3",dur:"1.5s",repeatCount:"indefinite"}),e.jsx("animate",{attributeName:"r",values:"4;8;4",dur:"1.5s",repeatCount:"indefinite"})]})]}),e.jsxs("div",{className:"text-center -mt-2",children:[e.jsx("span",{className:"text-4xl font-bold tabular-nums g-number-glow-pulse",style:{color:r,"--glow-color":`${b}60`,textShadow:`0 0 20px ${b}40, 0 0 40px ${b}20`},children:u.toFixed(1)}),e.jsx("span",{className:"text-sm ml-1",style:{color:"var(--g-text-secondary)"},children:n})]}),a&&e.jsx("span",{className:"text-xs mt-1 font-medium uppercase tracking-wider",style:{color:"var(--g-text-tertiary)"},children:a})]})}function X(t){return t.includes("--g-blue")||t==="#007AFF"?[0,122,255]:t.includes("--g-green")||t==="#34C759"?[52,199,89]:t.includes("--g-teal")?[0,199,190]:t.includes("--g-orange")?[255,149,0]:t.startsWith("#")&&t.length===7?[parseInt(t.slice(1,3),16),parseInt(t.slice(3,5),16),parseInt(t.slice(5,7),16)]:[0,122,255]}function K({direction:t,bandwidth:s,color:a}){const r=g.useRef(null),n=g.useRef([]),o=g.useRef(0),i=g.useRef({w:0,h:0}),m=g.useRef({direction:t,bandwidth:s,color:a});m.current={direction:t,bandwidth:s,color:a};const c=typeof window<"u"&&window.matchMedia("(prefers-reduced-motion: reduce)").matches,p=g.useCallback((h,u,y)=>{const f=m.current.bandwidth,N=Math.min(1,Math.max(.1,f/500));return{x:Math.random()*h,y:y?Math.random()*u:m.current.direction==="download"?-10:u+10,speed:(1+Math.random()*2)*(.5+N*2),radius:1+Math.random()*2.5,opacity:.3+Math.random()*.5}},[]);return g.useEffect(()=>{const h=r.current;if(!h)return;const u=h.getContext("2d");if(!u)return;if(c){const l=()=>{const x=h.getBoundingClientRect(),b=window.devicePixelRatio||1;h.width=x.width*b,h.height=x.height*b,u.scale(b,b);const[k,v,w]=X(m.current.color),$=u.createLinearGradient(0,0,0,x.height);$.addColorStop(0,`rgba(${k},${v},${w},0.03)`),$.addColorStop(.5,`rgba(${k},${v},${w},0.08)`),$.addColorStop(1,`rgba(${k},${v},${w},0.03)`),u.fillStyle=$,u.fillRect(0,0,x.width,x.height)};l();const d=new ResizeObserver(l);return d.observe(h),()=>d.disconnect()}const y=new ResizeObserver(l=>{for(const d of l){const{width:x,height:b}=d.contentRect,k=window.devicePixelRatio||1;h.width=x*k,h.height=b*k,i.current={w:x,h:b}}});y.observe(h);const f=h.clientWidth||400,N=h.clientHeight||300;i.current={w:f,h:N},n.current=Array.from({length:80},()=>p(f,N,!0));function R(){const{w:l,h:d}=i.current;if(l===0||d===0){o.current=requestAnimationFrame(R);return}const x=window.devicePixelRatio||1;u.clearRect(0,0,l*x,d*x),u.save(),u.scale(x,x);const{direction:b,bandwidth:k,color:v}=m.current,[w,$,T]=X(v),W=Math.min(120,Math.max(60,Math.floor(40+k/5))),C=n.current;for(;C.length<W;)C.push(p(l,d,!1));C.length>W+10&&C.splice(W,C.length-W),u.globalCompositeOperation="lighter",u.fillStyle=`rgb(${w},${$},${T})`;for(let A=C.length-1;A>=0;A--){const _=C[A];if(b==="download"){if(_.y+=_.speed,_.y>d+10){C[A]=p(l,d,!1);continue}}else if(_.y-=_.speed,_.y<-10){C[A]=p(l,d,!1);continue}u.globalAlpha=_.opacity,u.beginPath(),u.arc(_.x,_.y,_.radius*2,0,Math.PI*2),u.fill()}u.globalAlpha=1,u.restore(),o.current=requestAnimationFrame(R)}return o.current=requestAnimationFrame(R),()=>{cancelAnimationFrame(o.current),y.disconnect()}},[c,p]),e.jsx("canvas",{ref:r,className:"absolute inset-0 w-full h-full pointer-events-none",style:{opacity:.6}})}function U({samples:t,peak:s,color:a}){const r=g.useId(),n=`speed-graph-glow${r}`,o=`graph-fill-grad${r}`;if(t.length<2)return null;const i=320,m=80,c=4,p=4,h=4,u=i-c*2,y=m-p-h,f=Math.max(s*1.1,10),N=t[0].time,R=t[t.length-1].time,l=Math.max(R-N,1),d=t.map(v=>{const w=c+(v.time-N)/l*u,$=p+y-v.value/f*y;return{x:w,y:$}}),x=d.map(v=>`${v.x},${v.y}`).join(" "),b=`M ${d[0].x},${p+y} `+d.map(v=>`L ${v.x},${v.y}`).join(" ")+` L ${d[d.length-1].x},${p+y} Z`,k=d[d.length-1];return e.jsx("div",{className:"w-full max-w-xs mx-auto",children:e.jsxs("svg",{viewBox:`0 0 ${i} ${m}`,className:"w-full",style:{height:80},preserveAspectRatio:"none",children:[e.jsxs("defs",{children:[e.jsxs("filter",{id:n,x:"-20%",y:"-20%",width:"140%",height:"140%",children:[e.jsx("feGaussianBlur",{stdDeviation:"2",result:"blur"}),e.jsx("feFlood",{floodColor:a,floodOpacity:"0.5",result:"color"}),e.jsx("feComposite",{in:"color",in2:"blur",operator:"in",result:"glow"}),e.jsxs("feMerge",{children:[e.jsx("feMergeNode",{in:"glow"}),e.jsx("feMergeNode",{in:"SourceGraphic"})]})]}),e.jsxs("linearGradient",{id:o,x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:a,stopOpacity:"0.3"}),e.jsx("stop",{offset:"100%",stopColor:a,stopOpacity:"0.02"})]})]}),[.25,.5,.75].map(v=>{const w=p+y-v*y;return e.jsx("line",{x1:c,y1:w,x2:i-c,y2:w,stroke:"var(--g-border)",strokeWidth:"0.5",opacity:"0.3"},v)}),e.jsx("path",{d:b,fill:`url(#${o})`}),e.jsx("polyline",{points:x,fill:"none",stroke:a,strokeWidth:"2",strokeLinejoin:"round",strokeLinecap:"round",filter:`url(#${n})`}),e.jsxs("circle",{cx:k.x,cy:k.y,r:"4",fill:a,opacity:"0.9",children:[e.jsx("animate",{attributeName:"r",values:"3;5;3",dur:"1.5s",repeatCount:"indefinite"}),e.jsx("animate",{attributeName:"opacity",values:"0.9;0.5;0.9",dur:"1.5s",repeatCount:"indefinite"})]})]})})}function tt({elapsed:t,color:s="var(--g-text-secondary)"}){const a=Math.floor(t),r=Math.floor(a/60),n=a%60,o=`${r}:${String(n).padStart(2,"0")}`;return e.jsx("span",{className:"text-sm tabular-nums",style:{color:s,fontVariantNumeric:"tabular-nums"},children:o})}const st={idle:"var(--g-text-secondary)",started:"var(--g-teal)",ping:"var(--g-orange)",download:"var(--g-blue)",upload:"var(--g-green)",complete:"var(--g-blue)",error:"var(--g-red)"},at={download:"#007AFF",upload:"#34C759"},rt={idle:Pe,started:J,ping:L,download:O,upload:ce,complete:fe,error:Z};function z({label:t,value:s,unit:a,color:r,icon:n,delay:o}){const i=ee(s,900);return e.jsx("div",{className:"g-animate-in",style:{animationDelay:`${o}ms`},children:e.jsxs(F,{padding:"md",depth:"elevated",className:"text-center relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 right-0",style:{height:3,background:`linear-gradient(90deg, transparent, ${r}, transparent)`}}),e.jsx(n,{className:"w-4 h-4 mx-auto mb-2",style:{color:r,opacity:.7}}),e.jsx("span",{className:"text-3xl font-bold tabular-nums block g-number-glow-pulse",style:{color:r,"--glow-color":`${r}40`},children:i.toFixed(1)}),e.jsx("span",{className:"text-[11px] block mt-0.5",style:{color:"var(--g-text-secondary)"},children:a}),e.jsx("span",{className:"text-[10px] font-semibold block mt-1.5 uppercase tracking-widest",style:{color:"var(--g-text-tertiary)"},children:t})]})})}function B({icon:t,value:s,unit:a,color:r}){return e.jsxs("span",{className:"inline-flex items-center gap-1 text-xs tabular-nums",style:{color:"var(--g-text-secondary)"},children:[e.jsx(t,{className:"w-3 h-3",style:{color:r,opacity:.8}}),e.jsx("span",{style:{color:r},children:s}),e.jsx("span",{className:"text-[10px]",children:a})]})}function nt({progress:t}){const{t:s}=S(),a=t.phase,r=st[a]||"var(--g-blue)",n=rt[a]||L,o=a!=="idle"&&a!=="complete"&&a!=="error",i=a==="download"||a==="upload",m={idle:s("speedtest.idle"),started:s("speedtest.started"),ping:s("speedtest.ping"),download:s("speedtest.download"),upload:s("speedtest.upload"),complete:s("speedtest.complete"),error:s("speedtest.error")},c=et(),p=g.useRef(a),[h,u]=g.useState(null),[y,f]=g.useState(null);return g.useEffect(()=>{a==="ping"&&t.ping_ms&&u(t.ping_ms),a==="download"&&t.bandwidth_mbps&&f(t.bandwidth_mbps),a==="idle"&&(u(null),f(null))},[a,t.ping_ms,t.bandwidth_mbps]),g.useEffect(()=>{p.current!==a&&((a==="download"||a==="upload")&&c.reset(),p.current=a),i&&t.bandwidth_mbps!==void 0&&t.elapsed!==void 0&&c.push(t.bandwidth_mbps,t.elapsed)},[a,t.bandwidth_mbps,t.elapsed,i,c]),e.jsxs(F,{padding:"none",depth:"elevated",className:"relative overflow-hidden",children:[i&&e.jsx(K,{direction:a,bandwidth:t.bandwidth_mbps||0,color:at[a]||r}),a==="started"&&e.jsx(K,{direction:"download",bandwidth:5,color:"var(--g-teal)"}),e.jsxs("div",{className:"relative z-10 flex flex-col items-center gap-5 py-8 px-6",children:[e.jsxs("div",{className:"flex items-center justify-between w-full max-w-md",children:[e.jsxs(ge,{color:r,children:[o&&e.jsx("span",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{background:r,boxShadow:`0 0 8px ${r}`,animation:"g-breathe 1.5s ease-in-out infinite"}}),e.jsx(n,{className:"w-3.5 h-3.5"}),m[a]||a]}),e.jsxs("div",{className:"flex items-center gap-3",children:[a==="download"&&h!==null&&e.jsx(B,{icon:L,value:h.toFixed(0),unit:"ms",color:"var(--g-orange)"}),a==="upload"&&e.jsxs(e.Fragment,{children:[h!==null&&e.jsx(B,{icon:L,value:h.toFixed(0),unit:"ms",color:"var(--g-orange)"}),y!==null&&e.jsx(B,{icon:O,value:y.toFixed(0),unit:"Mbps",color:"var(--g-blue)"})]}),o&&t.elapsed!==void 0&&e.jsx(tt,{elapsed:t.elapsed,color:r})]})]},a),e.jsxs("div",{className:"w-full flex flex-col items-center gap-4 g-phase-enter",children:[a==="started"&&e.jsxs("div",{className:"flex flex-col items-center gap-5 py-4",children:[e.jsx(q,{value:30,max:100,size:130,strokeWidth:5,color:"var(--g-teal)",glow:!0,children:e.jsx(J,{className:"w-9 h-9",style:{color:"var(--g-teal)",animation:"g-breathe 2s ease-in-out infinite"}})}),e.jsxs("p",{className:"text-sm font-medium",style:{color:"var(--g-text-secondary)"},children:[s("speedtest.started"),"..."]})]}),a==="ping"&&e.jsx("div",{className:"flex flex-col items-center gap-4 py-2",children:e.jsx(q,{value:(t.progress||0)*100,max:100,size:160,strokeWidth:6,color:"var(--g-orange)",glow:!0,children:e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"text-4xl font-bold tabular-nums g-number-glow-pulse",style:{color:"var(--g-orange)","--glow-color":"rgba(255, 149, 0, 0.4)"},children:(t.ping_ms||0).toFixed(1)}),e.jsx("span",{className:"text-xs block mt-0.5",style:{color:"var(--g-text-secondary)"},children:"ms"})]})})}),a==="download"&&e.jsxs("div",{className:"w-full flex flex-col items-center gap-3",children:[e.jsx(V,{value:t.bandwidth_mbps||0,label:s("speedtest.downloadResult"),color:"var(--g-blue)",glowColor:"#007AFF"}),e.jsx("div",{className:"w-full max-w-xs",children:e.jsx("div",{className:"border-t pt-2",style:{borderColor:"var(--g-border)"},children:e.jsx(U,{samples:c.samples,peak:c.peak,color:"var(--g-blue)",version:c.version})})})]}),a==="upload"&&e.jsxs("div",{className:"w-full flex flex-col items-center gap-3",children:[e.jsx(V,{value:t.bandwidth_mbps||0,label:s("speedtest.uploadResult"),color:"var(--g-green)",glowColor:"#34C759"}),e.jsx("div",{className:"w-full max-w-xs",children:e.jsx("div",{className:"border-t pt-2",style:{borderColor:"var(--g-border)"},children:e.jsx(U,{samples:c.samples,peak:c.peak,color:"var(--g-green)",version:c.version})})})]}),a==="complete"&&e.jsx("div",{className:"w-full max-w-md py-2",children:e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsx(z,{label:s("speedtest.downloadResult"),value:t.download_mbps||0,unit:s("common.mbps"),color:"var(--g-blue)",icon:O,delay:0}),e.jsx(z,{label:s("speedtest.uploadResult"),value:t.upload_mbps||0,unit:s("common.mbps"),color:"var(--g-green)",icon:ce,delay:120}),e.jsx(z,{label:s("speedtest.pingResult"),value:t.ping_ms||0,unit:s("common.ms"),color:"var(--g-orange)",icon:L,delay:240})]})}),a==="error"&&e.jsxs("div",{className:"text-center g-animate-in py-4",children:[e.jsx(Z,{className:"w-8 h-8 mx-auto mb-3",style:{color:"var(--g-red)",opacity:.8}}),e.jsx("p",{className:"text-sm font-medium",style:{color:"var(--g-red)"},children:t.message||"An error occurred"})]})]},`content-${a}`),i&&t.progress!==void 0&&e.jsxs("div",{className:"w-full max-w-xs",children:[e.jsx("div",{className:"glass-progress",style:{height:5},children:e.jsx("div",{className:"glass-progress-bar",style:{width:`${Math.min(100,(t.progress||0)*100)}%`,background:`linear-gradient(90deg, ${r}90, ${r})`,boxShadow:`0 0 12px ${r}50`,transition:"width 0.3s ease-out"}})}),e.jsxs("p",{className:"text-[10px] text-center mt-1.5 tabular-nums font-medium",style:{color:"var(--g-text-tertiary)"},children:[Math.round((t.progress||0)*100),"%"]})]})]})]})}function vt(){const{t}=S(),{data:s,isLoading:a}=ve(),{data:r}=je({page_size:50}),{data:n}=ye(),{data:o}=be(),{data:i}=we(),{progress:m,isStreaming:c,testActive:p}=Ne();if(a)return e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx(ke,{size:32})});const h=p||c||m.phase!=="idle"&&m.phase!=="complete"&&m.phase!=="error";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2 g-animate-in",style:{color:"var(--g-text)"},children:[e.jsx(_e,{className:"w-5 h-5"}),t("dashboard.title")]}),(i==null?void 0:i.outage)&&e.jsx(Je,{outage:i.outage}),h&&e.jsx("div",{className:"g-animate-scale",children:e.jsx(nt,{progress:m})}),!h&&s?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 g-animate-in g-stagger-1",children:[e.jsx(H,{label:t("dashboard.download"),sublabel:t("dashboard.latestTest"),value:s.download_mbps,color:"var(--g-blue)",threshold:n==null?void 0:n.effective_download_threshold_mbps,thresholdLabel:n?t("dashboard.minThreshold",{value:n.effective_download_threshold_mbps}):void 0}),e.jsx(H,{label:t("dashboard.upload"),sublabel:t("dashboard.latestTest"),value:s.upload_mbps,color:"var(--g-green)",threshold:n==null?void 0:n.effective_upload_threshold_mbps,thresholdLabel:n?t("dashboard.minThreshold",{value:n.effective_upload_threshold_mbps}):void 0}),e.jsx(H,{label:t("dashboard.ping"),sublabel:t("dashboard.latestTest"),value:s.ping_latency_ms,unit:t("common.ms"),color:"var(--g-orange)"})]}),(o==null?void 0:o.isp_score)&&e.jsx("div",{className:"g-animate-in g-stagger-2",children:e.jsx(Ze,{score:o.isp_score})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 g-animate-in g-stagger-3",children:[e.jsx(Ee,{measurement:s}),e.jsx(Xe,{})]}),r&&r.items.length>1&&e.jsxs("div",{className:"space-y-4 g-animate-in g-stagger-4",children:[e.jsx(qe,{measurements:r.items,downloadThreshold:n==null?void 0:n.effective_download_threshold_mbps,uploadThreshold:n==null?void 0:n.effective_upload_threshold_mbps}),e.jsx(Ye,{measurements:r.items})]})]}):h?null:e.jsxs("div",{className:"text-center py-20 g-animate-in",style:{color:"var(--g-text-secondary)"},children:[e.jsx("p",{className:"text-lg font-medium",children:t("dashboard.noMeasurements")}),e.jsx("p",{className:"text-sm mt-1",children:t("dashboard.noMeasurementsHint")})]})]})}export{vt as DashboardPage};
